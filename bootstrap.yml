---
- name: bootstrap-script
  hosts: localhost
  connection: local

  vars:
    hostname: phoenix

    # pre-install
    ssh_reset: true
    ssh_persist:
     - name: id_ed25519
     - name: id_ed25519.pub

    # utilities
    utils_persist:
      - name: asdf
      - name: coreutils
      - name: curl
      - name: git
      - name: gpg
      - name: openssl
      - name: poetry
      - name: readline
      - name: ripgrep
      - name: sqlite3
      - name: tcl-tk
      - name: tox
      - name: xz
      - name: zlib

    # languages
    langs_persist:
      - name: nasm
      - name: cmake
    langs_asdf_plugins:
      - name: python
      - name: nodejs
        repository: https://github.com/asdf-vm/asdf-nodejs.git
    langs_asdf_python:
      - version: 3.8.10
      - version: 3.9.1
      - version: 3.11.5
    langs_asdf_nodejs:
      - version: 20.5.1

    # fonts
    fonts_persist:
     - name: JetBrains Mono Nerd Font
       tap: homebrew/cask-fonts
       cask: font-jetbrains-mono-nerd-font

    # terminal
    oh_my_zsh_install: true

    # editors
    doom_emacs_install: true
    neovim_install: true

    # applications
    apps_persist:
     - cask: alfred
     - cask: arc
     - cask: google-drive
     - cask: shadow
     - cask: spotify
     - cask: whatsapp

    # dock
    dockitems_reset: true
    dockitems_persist:
     - name: Emacs
       path: /Applications/Emacs.app
       pos: 1
     - name: Arc
       path: /Applications/Arc.app
       pos: 2
     - name: Shadow
       path: /Applications/Shadow\ PC.app
       pos: 3
     - name: WhatsApp
       path: /Applications/WhatsApp.app
       pos: 4
     - name: Spotify
       path: /Applications/Spotify.app
       pos: 5
       # TODO add capability to add a line spacer

    # post-install
    repos_persist:
      - name: Notes
        git: git@github.com:shaun-moate/notes.git
        path: "{{ lookup('ansible.builtin.env', 'HOME') }}/Notes"
      - name: Work-Notes
        git: git@github.com:shaun-moate/work-notes.git
        path: "{{ lookup('ansible.builtin.env', 'HOME') }}/Work"
      - name: ml-bootstrap-example
        git: git@github.com:shaun-moate/ml-bootstrap-example.git
        path: "{{ lookup('ansible.builtin.env', 'HOME') }}/Code/ml-bootstrap-example"
    dotfiles_install: true
    doom_sync: true

  roles:
    - pre-install
    - utils
    # TODO add cli support (ie. aws-cli)
    # TODO add tmux support
    - langs
    # TODO add lua support
    # TODO add typescript/node support
    - fonts
    - term
    - editors
    - apps
    # TODO look at VMWare, more?
    - dock
    - post-install
